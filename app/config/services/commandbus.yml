services:

    _defaults:
        autowire: true
        public: true

    eTraxis\CommandBus\:
        resource: '../../../src/eTraxis/CommandBus/*/Handler'

    # Alias for autowiring
    League\Tactician\CommandBus: '@tactician.commandbus'

    # Custom middleware
    tactician.middleware.timing:
        class: eTraxis\CommandBus\TimingMiddleware
        public: false

    # Custom handler locator
    eTraxis\CommandBus\HandlerLocator:
        public: false
        calls: [[ setContainer, [ '@service_container' ] ]]

    # Overridden command handler middleware to inject custom handler locator
    tactician.middleware.command_handler:
        class: League\Tactician\Handler\CommandHandlerMiddleware
        public: false
        arguments:
            - '@tactician.handler.command_name_extractor.class_name'
            - '@eTraxis\CommandBus\HandlerLocator'
            - '@tactician.handler.method_name_inflector.handle'

    # Autowiring hints
    eTraxis\CommandBus\User\Handler\LockAccountHandler:
        $authFailures: '%auth_failures%'
        $lockDuration: '%lock_duration%'

    # Autowiring hints
    eTraxis\CommandBus\User\Handler\RegisterExternalAccountHandler:
        $locale: '%locale%'
